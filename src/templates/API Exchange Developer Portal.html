<!DOCTYPE html>
<!-- saved from url=(0057)https://portal.axpuat.cpf.gov.sg/test_workspace_01/guides -->
<html sigplusextliteextension-installed="true" extension-version="2.0.15.0">
<head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>API Exchange Developer Portal</title>
  <!--<base href="https://portal.axpuat.cpf.gov.sg/test_workspace_01/">--><base href=".">
  <link rel="preconnect" href="https://fonts.gstatic.com/" crossorigin="">

  <style>
    /* Values */
    :root {

        --hero: #0A6160;

        --text_hero: #FFFFFF;

        --header: #FFFFFF;

        --accent: #3C9392;

        --page: #FFFFFF;

        --text_links: #0A6160;

        --text_headings: #000000;

    }

    /* Utilities */

    .color-hero {
      color: var(--hero);
    }

    .bg-hero {
      background-color: var(--hero);
    }

    .color-text_hero {
      color: var(--text_hero);
    }

    .bg-text_hero {
      background-color: var(--text_hero);
    }

    .color-header {
      color: var(--header);
    }

    .bg-header {
      background-color: var(--header);
    }

    .color-accent {
      color: var(--accent);
    }

    .bg-accent {
      background-color: var(--accent);
    }

    .color-page {
      color: var(--page);
    }

    .bg-page {
      background-color: var(--page);
    }

    .color-text_links {
      color: var(--text_links);
    }

    .bg-text_links {
      background-color: var(--text_links);
    }

    .color-text_headings {
      color: var(--text_headings);
    }

    .bg-text_headings {
      background-color: var(--text_headings);
    }


    /* Font Families */
    body {
      font-family: "", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    }
    pre,code,kbd {
      font-family: inherit;
      font-family: "";
    }
    h1, h2, h2, h3, h4, h5, h6 {
      font-family: "", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
    }

    #editor { 
          position: relative;
          top: 0;
          right: 0;
          bottom: 0;
          left: 0;
          height: 30cm;
          margin-bottom: 3rem;
      }
    
    .styled-table {
      border-collapse: collapse;
      margin: 25px 0;
      font-size: 0.9em;
      font-family: sans-serif;
      min-width: 400px;
      box-shadow: 0 0 20px rgba(0, 0, 0, 0.15);
    }

    .styled-table thead th {
      background-color: #0A6160;
      color: #ffffff;
      text-align: left;
    }

    .styled-table .secondary-col {
      width: 100%;
    }

    .styled-table th,
    .styled-table td {
      padding: 15px !important;
    }

    .styled-table tbody tr {
      border-bottom: 1px solid #dddddd;
    }

    .styled-table tbody tr:nth-of-type(even) {
      background-color: #f3f3f3;
    }

    .styled-table tbody tr:last-of-type {
      border-bottom: 2px solid #0A6160;
    }

    .styled-table tbody tr.active-row {
      font-weight: bold;
      color: #009879;
    }

    th:first-of-type {
      border-top-left-radius: 10px;
    }

    th:last-of-type {
      border-top-right-radius: 10px;
    }

    tr:last-of-type td:first-of-type {
      border-bottom-left-radius: 10px;
    }

    tr:last-of-type td:last-of-type {
      border-bottom-right-radius: 10px;
    }

  </style>

  <link href="static/css/bootstrap.min.css" rel="stylesheet" type="text/css">
  <link href="static/css/highlight.min.css" rel="stylesheet" type="text/css">
  <link href="static/css/framework.min.css" rel="stylesheet" type="text/css">
  <link href="static/css/site.css" rel="stylesheet" type="text/css">

</head>

<body>
    
  <header class="site-header">
    <div class="container">
      <div class="row">
        <div class="four columns">
          <h1 class="brand"><a href="https://portal.axpuat.cpf.gov.sg/test_workspace_01"><img class="logo" src="/static/images/Logo.png" alt="API Exchange Developer Portal"></a></h1>
        </div>
      </div>
    </div>
  </header>

  <div class="page vh-100">
    <div class="container h-100 py-5 d-flex flex-column">
      <h3 class="route-identifier">CPF OAS Validator Tool</h3>
      <!-- OAS Text Box -->
      <p style="margin-bottom: 2rem !important;">Paste the content of your OAS in the field below, and click the "How is my OAS?" button to check if there are any errors on the OAS format.</p>
      <div id="editor">
        <textarea id="oasTextarea" class="form-control flex-fill" method="post" wrap="off" style="font-size:1.5rem; margin-bottom: 2rem;height:100%; height: 10cm;"></textarea>
      </div>
      <!-- Upload Feature -->
      <input class="my-0 align-self-start" id="fileUpload" type="file" style="margin-bottom: 3rem; padding-bottom: 1cm; display: inline-block;"/>
      <button id="fileUploadButton" style="display: inline-block;" onclick=uploadFile()>Upload</button>
      <!-- Save Text to File Feature -->
      <button id="savefile" onclick="saveFile()">Save to File</button>
      <!-- Check OAS -->
      <button class="btn noBorder my-0 px-5 align-self-start" id="checkOASButton" style="background-color: rgb(10, 97, 96); color: white; font-size: 1em; text-transform: none; height: auto; padding: 8px 15px; border-radius: 5px; margin-bottom: 5rem;" onclick=extractOAS()>How is my OAS?</button>
      <!-- Dictionary Text Box -->
      <p wrap="on" style="margin-bottom: 2rem !important; margin-top: 1rem !important;">Paste dictionary word here (from least important to most important order):</p>
      <grammarly-editor-plugin contenteditable="true">
        <textarea id="oasDictionaryArea" class="form-control flex-fill" wrap="off" style="font-size:1.5rem; margin-bottom: 2rem; width: 50%; height: 1cm;">
discretionary
withdrawals
update
member
credit
status
for
pay
now
eligibility
check
age</textarea></grammarly-editor-plugin>
    </div>
  </div>

  <div id="spec-url" style="display: none">
    documentation/untitled
  </div>

  <!-- Modals -->
  <link href="static/css/swagger-ui.css" rel="stylesheet" type="text/css">
  <div class="modal fade" id="oasSuccess" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content" style="min-height:100%;">
        <div class="modal-header">
          <h5 class="modal-title" id="staticSuccessBackdropLabel">OAS Checker</h5>
          <button type="button" class="btn-close noBorder" style="padding:1rem 2rem;" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body" id="oasSuccessBody">
        </div>
      </div>
    </div>
  </div>

  <div class="modal fade" id="oasErrors" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" role="dialog">
    <div class="modal-dialog modal-xl modal-dialog-scrollable">
      <div class="modal-content" style="min-height:100%;">
        <div class="modal-header">
          <h5 class="modal-title" id="staticErrorsBackdropLabel">OAS Checker</h5>
          <button type="button" class="btn-close noBorder" style="padding:1rem 2rem;" data-bs-dismiss="modal"></button>
        </div>
        <div class="modal-body"> 
            <table class = "styled-table">
                <thead>
                  <tr>
                    <th scope="col">#</th>
                    <th scope="col" class="secondary-col">Errors</th>
                  </tr>
                </thead>
                <tbody id="oasErrorsBody">
                </tbody>
            </table>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
          <button type="button" class="btn btn-primary" data-bs-dismiss="modal" onclick="">Save Changes</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/static/js/bootstrap.bundle.min.js.download"></script>
  <script src="/static/js/swagger-ui-bundle.js.download"></script>
  <script src="/static/js/js-yaml-3.13.1.min.js.download"></script>
  <script src="/static/js/jquery.min.js.download"></script>
  <script src="https://cdn.jsdelivr.net/npm/@grammarly/editor-sdk?clientId=client_G9BZTBHKX7chBEXcHdt3ND"></script>
  <script src="https://cdn.jsdelivr.net/npm/ace-builds@1.19.0/src-min-noconflict/ace.min.js"></script>
  <link href="https://cdn.jsdelivr.net/npm/ace-builds@1.19.0/css/ace.min.css" rel="stylesheet">

  <script>
    var editor = ace.edit("editor");
    editor.setTheme("ace/theme/kuroir");
    editor.getSession().setMode("ace/mode/yaml");
    document.getElementById('editor').style.fontSize='15px';

    function uploadFile() {
        var file = document.getElementById("fileUpload").files[0];
        if (file != undefined) {
          var reader = new FileReader();
          reader.onload = function(e) {
          // var textArea = document.getElementById("oasTextarea");
          // textArea.value = e.target.result;
          editor.setValue(e.target.result);
          }
          reader.readAsText(file);
        } else {
          alert("No file provided!");
        }
      }

    function saveFile() {
      // var textArea = document.getElementById("oasTextarea").value;
      var textArea = editor.getValue();
      if (textArea == "") {
        alert("Please input an OAS before saving to file!");
        return;
      } else if (fileName = prompt("Save file as", "")) {
        var textBlob = new Blob([textArea], {type:"text/plain"});
        var downloadLink = document.createElement("a");
        downloadLink.download = fileName;
        downloadLink.innerHTML = textBlob;
        if (window.webkitURL != null) { // Chrome
          downloadLink.href = window.webkitURL.createObjectURL(textBlob);
        } else { // Firefox
          downloadLink.href = window.URL.createObjectURL(textBlob);
          downloadLink.onclick = destroyClickedElement;
          downloadLink.style.display = "none";
          document.body.appendChild(downloadLink);
        }
        downloadLink.click();
      }
    }

    function extractOAS() {
      // $(document).ready(function() {
      //   $('#checkOASButton').unbind('click').on('click', function(e) {
          
      //     e.preventDefault();
      //     e.stopImmediatePropagation();

          // var data = $('#oasTextarea').val();
          var data = editor.getValue();
          if (data == "") {
            alert("Please input an OAS!");
            return;
          }
          var dictionaryWords = $('#oasDictionaryArea').val().split(/\r?\n/);
          var dictionaryWordsDictionary = {dictionary: dictionaryWords}
          dictionary = JSON.stringify(dictionaryWordsDictionary);
          const doc = jsyaml.safeLoad(data, {schema: jsyaml.JSON_SCHEMA});
          var doc_json = JSON.stringify(doc)
          
          $.ajax({
            data: {
              doc: doc_json,
              dictionary: dictionary,
            },
            type: 'POST',
            url: '/checkOAS',
            success: function(response) {
              oasSuccessModal = $('#oasSuccess');
              oasSuccessModal.find('.modal-body').html(`<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-check" viewBox="0 0 16 16"><path d="M10.97 4.97a.75.75 0 0 1 1.07 1.05l-3.99 4.99a.75.75 0 0 1-1.08.02L4.324 8.384a.75.75 0 1 1 1.06-1.06l2.094 2.093 3.473-4.425a.267.267 0 0 1 .02-.022z"/></svg>`);
              oasSuccessModal.find('.modal-body').append("There are no additional errors found");
              oasSuccessModal.modal("show");
            },
            error: function(response) {
              listErrors = response["responseJSON"]["errors"];
              
              oasErrorModal = $('#oasErrors');
              oasErrorModal.find('.styled-table tbody').empty();
              for (let i = 0; i < listErrors.length; i++){
                oasErrorModal.find('.styled-table tbody').append(`<tr>
                                                            <td scope="row">`+(i+1)+`</th>
                                                            <td>`+(listErrors[i])+`</td>
                                                          </tr>
                                                        `);
              }
              oasErrorModal.modal("show");
            }
          });
      //   });
      // })
    }

  </script>
    
<script src="/static/js/kong.utils.js.download"></script>

</body>

</html>